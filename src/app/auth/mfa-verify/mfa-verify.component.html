<div class="auth-page">
  <div class="auth-card">
    <!-- Back link -->
    <a class="auth-back-link" (click)="backToLogin()" style="cursor: pointer;">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
           fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m15 18-6-6 6-6"/>
      </svg>
      Back to login
    </a>

    <!-- Header -->
    <div class="auth-header">
      <div class="auth-logo">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"
             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect width="18" height="11" x="3" y="11" rx="2" ry="2"/>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        </svg>
      </div>
      <h1>Two-factor authentication</h1>
      <p>
        @if (useRecoveryCode()) {
          Enter one of your recovery codes
        } @else {
          Enter the 6-digit code from your authenticator app
        }
      </p>
    </div>

    <!-- Error Message -->
    @if (error()) {
      <div class="auth-alert auth-alert-error">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" x2="12" y1="8" y2="12"/>
          <line x1="12" x2="12.01" y1="16" y2="16"/>
        </svg>
        <span>{{ error() }}</span>
      </div>
    }

    <!-- MFA Form -->
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="auth-field">
        <label for="code">
          {{ useRecoveryCode() ? 'Recovery code' : 'Verification code' }}
        </label>
        <input
          id="code"
          type="text"
          formControlName="code"
          [placeholder]="useRecoveryCode() ? 'XXXX-XXXX' : '000000'"
          autocomplete="one-time-code"
          inputmode="numeric"
          [class.invalid]="form.get('code')?.touched && form.get('code')?.invalid"
          autofocus
        />
      </div>

      <button
        type="submit"
        class="auth-btn-primary"
        [disabled]="loading()"
      >
        @if (loading()) {
          <span class="spinner"></span>
          Verifying...
        } @else {
          Verify
        }
      </button>
    </form>

    <!-- Toggle recovery code -->
    <div class="auth-footer">
      @if (useRecoveryCode()) {
        <span>Have your authenticator app?</span>
        <a (click)="toggleRecoveryCode()" style="cursor: pointer;">Use verification code</a>
      } @else {
        <span>Lost access to your authenticator?</span>
        <a (click)="toggleRecoveryCode()" style="cursor: pointer;">Use a recovery code</a>
      }
    </div>
  </div>
</div>
