<aside class="app-sidebar" [class.show]="isOpen" [class.collapsed]="isCollapsed">
  <!-- Header -->
  <div class="sidebar-header">
    <a routerLink="/" class="sidebar-brand" (click)="isMobile && close()">
      <svg
        class="brand-logo"
        [class.collapsed]="isCollapsed"
        xmlns="http://www.w3.org/2000/svg"
        [attr.viewBox]="isCollapsed ? '418 382 300 235' : '418 382 694 235'"
        role="img"
        aria-label="Egibi logo">
        <g fill="currentColor" fill-rule="evenodd">
          <!-- Lion icon -->
          <path d="M481 459L493 459L494 460L503 460L504 459L507 459L508 458L509 458L510 457L511 457L512 456L513 456L514 455L515 455L516 454L517 454L519 452L520 452L523 449L524 449L525 448L524 447L521 447L520 446L516 446L515 445L512 445L511 444L508 444L507 443L504 443L503 442L495 442L492 445L492 446L490 448L490 449L481 458Z"/>
          <path d="M679 406L522 384L474 437L418 475L442 524L478 526L463 540L448 537L454 559L499 560L522 616L545 608L541 552L562 602L604 581L555 505L517 491L510 522L447 512L437 490L451 474L441 471L477 447L497 422L596 410L587 433L557 447L573 466L559 498L620 568L665 535L599 472L673 514L695 481L623 439L688 461ZM598 471L599 470L600 471L599 472ZM596 470L597 469L598 469L599 470L598 471L597 471Z"/>
          <!-- Wordmark (hidden when collapsed) -->
          @if (!isCollapsed) {
            <path d="M755 486L747 494L741 511L742 526L747 538L758 548L772 553L793 553L809 547L815 540L812 535L804 535L797 539L789 541L778 541L772 539L763 531L761 523L763 521L816 521L819 518L819 508L817 500L813 493L805 485L790 479L773 479L764 481ZM761 504L762 503L762 502L763 501L763 500L769 494L770 494L772 492L774 492L775 491L788 491L789 492L790 492L791 493L792 493L798 499L798 500L799 501L799 503L800 504L800 508L798 510L762 510L761 509Z"/>
            <path d="M858 480L846 486L836 499L833 510L833 520L836 532L840 539L847 546L861 552L876 552L883 550L895 542L896 556L893 563L885 570L878 572L862 572L845 568L843 577L847 581L865 585L880 585L894 582L903 577L910 570L915 557L916 482L910 480L899 481L895 488L891 484L878 479ZM873 491L878 491L879 492L882 492L883 493L885 493L887 495L888 495L893 500L893 501L896 506L896 509L897 510L897 518L896 519L896 525L895 526L894 529L892 531L892 532L888 536L887 536L882 539L877 539L876 540L875 540L874 539L869 539L868 538L866 538L865 537L864 537L862 535L861 535L857 531L857 530L854 525L854 522L853 521L853 509L854 508L854 506L855 505L857 500L862 495L863 495L868 492L872 492Z"/>
            <path d="M944 480L941 482L941 550L942 551L959 551L960 550L960 482L958 480Z"/>
            <path d="M950 446L949 447L946 447L945 448L944 448L943 449L942 449L940 451L940 452L939 453L939 461L940 462L940 463L944 467L947 467L948 468L953 468L954 467L956 467L957 466L958 466L962 462L962 461L963 460L963 455L962 454L962 452L958 448L957 448L956 447L953 447L952 446Z"/>
            <path d="M989 446L986 449L986 549L988 551L1004 551L1006 546L1008 545L1013 549L1023 553L1040 553L1055 547L1063 539L1067 531L1069 522L1069 510L1065 496L1055 485L1040 479L1022 480L1015 483L1007 489L1006 488L1006 448L1004 446ZM1023 492L1032 492L1033 493L1036 493L1037 494L1038 494L1040 496L1041 496L1045 500L1045 501L1047 504L1047 506L1048 507L1048 509L1049 510L1049 523L1048 524L1048 526L1046 529L1046 531L1039 538L1038 538L1035 540L1032 540L1031 541L1023 541L1022 540L1019 540L1018 539L1015 538L1009 532L1009 531L1007 528L1007 526L1006 525L1006 508L1007 507L1007 505L1008 504L1008 503L1013 497L1014 497L1016 495L1017 495L1020 493L1022 493Z"/>
            <path d="M1092 480L1089 482L1089 550L1090 551L1107 551L1108 550L1108 542L1109 541L1109 538L1108 537L1108 531L1109 530L1109 483L1106 480Z"/>
            <path d="M1093 447L1092 448L1091 448L1088 451L1088 452L1087 453L1087 461L1088 462L1088 463L1091 466L1092 466L1093 467L1094 467L1095 468L1102 468L1103 467L1104 467L1105 466L1106 466L1109 463L1109 462L1110 461L1110 459L1111 458L1111 456L1110 455L1110 452L1106 448L1105 448L1104 447L1102 447L1101 446L1097 446L1096 447Z"/>
          }
        </g>
      </svg>
    </a>
    
    <!-- Collapse Toggle (desktop only) -->
    @if (!isMobile) {
      <button class="collapse-toggle" (click)="toggleCollapse()" [attr.aria-label]="isCollapsed ? 'Expand sidebar' : 'Collapse sidebar'">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" [class.rotated]="isCollapsed">
          <path d="m15 18-6-6 6-6"/>
        </svg>
      </button>
    }
  </div>

  <!-- Navigation -->
  <nav class="sidebar-nav">
    @for (section of navSections; track section.title) {
      <div class="sidebar-section">
        @if (section.title) {
          <p class="sidebar-section-title" [class.hidden]="isCollapsed">{{ section.title }}</p>
          @if (isCollapsed) {
            <div class="section-divider"></div>
          }
        }
        
        @for (item of section.items; track item.route) {
          <a [routerLink]="item.route" 
             routerLinkActive="active" 
             [routerLinkActiveOptions]="{exact: item.exact ?? false}"
             class="sidebar-link"
             [ngbTooltip]="isCollapsed ? item.label : null"
             placement="right"
             container="body"
             (click)="isMobile && close()">
            <span class="sidebar-icon">
              <!-- Dashboard -->
              @if (item.icon === 'dashboard') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect width="7" height="9" x="3" y="3" rx="1"/>
                  <rect width="7" height="5" x="14" y="3" rx="1"/>
                  <rect width="7" height="9" x="14" y="12" rx="1"/>
                  <rect width="7" height="5" x="3" y="16" rx="1"/>
                </svg>
              }
              <!-- Wallet -->
              @if (item.icon === 'wallet') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"/>
                  <path d="M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"/>
                </svg>
              }
              <!-- Exchange -->
              @if (item.icon === 'exchange') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="m16 3 4 4-4 4"/>
                  <path d="M20 7H4"/>
                  <path d="m8 21-4-4 4-4"/>
                  <path d="M4 17h16"/>
                </svg>
              }
              <!-- Chart -->
              @if (item.icon === 'chart') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 3v18h18"/>
                  <path d="m19 9-5 5-4-4-3 3"/>
                </svg>
              }
              <!-- Zap -->
              @if (item.icon === 'zap') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                </svg>
              }
              <!-- Clock -->
              @if (item.icon === 'clock') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
              }
              <!-- Calculator -->
              @if (item.icon === 'calculator') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect width="16" height="20" x="4" y="2" rx="2"/>
                  <line x1="8" x2="16" y1="6" y2="6"/>
                  <line x1="16" x2="16" y1="14" y2="18"/>
                  <path d="M16 10h.01"/>
                  <path d="M12 10h.01"/>
                  <path d="M8 10h.01"/>
                  <path d="M12 14h.01"/>
                  <path d="M8 14h.01"/>
                  <path d="M12 18h.01"/>
                  <path d="M8 18h.01"/>
                </svg>
              }
              <!-- Database -->
              @if (item.icon === 'database') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <ellipse cx="12" cy="5" rx="9" ry="3"/>
                  <path d="M3 5V19A9 3 0 0 0 21 19V5"/>
                  <path d="M3 12A9 3 0 0 0 21 12"/>
                </svg>
              }
              <!-- Terminal -->
              @if (item.icon === 'terminal') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="4 17 10 11 4 5"/>
                  <line x1="12" x2="20" y1="19" y2="19"/>
                </svg>
              }
              <!-- Settings -->
              @if (item.icon === 'settings') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
              }
              <!-- Shield -->
              @if (item.icon === 'shield') {
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/>
                </svg>
              }
            </span>
            <span class="sidebar-link-text" [class.hidden]="isCollapsed">{{ item.label }}</span>
          </a>
        }
      </div>
    }
  </nav>

  <!-- Footer -->
  <div class="sidebar-footer">
    <div class="footer-content" [class.collapsed]="isCollapsed">
      @if (!isCollapsed) {
        <div class="d-flex align-items-center">
          <span class="avatar avatar-sm">A</span>
          <span class="ms-2 small fw-medium">Admin</span>
        </div>
      }
      <button class="btn btn-ghost btn-icon btn-sm" 
              (click)="toggleTheme()" 
              [ngbTooltip]="isDarkMode ? 'Light mode' : 'Dark mode'"
              placement="right"
              container="body">
        @if (!isDarkMode) {
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
          </svg>
        } @else {
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="4"/>
            <path d="M12 2v2"/>
            <path d="M12 20v2"/>
            <path d="m4.93 4.93 1.41 1.41"/>
            <path d="m17.66 17.66 1.41 1.41"/>
            <path d="M2 12h2"/>
            <path d="M20 12h2"/>
            <path d="m6.34 17.66-1.41 1.41"/>
            <path d="m19.07 4.93-1.41 1.41"/>
          </svg>
        }
      </button>
    </div>
  </div>
</aside>

<!-- Mobile Overlay -->
<div class="sidebar-overlay" [class.show]="isOpen && isMobile" (click)="close()"></div>
